#!/bin/bash
# Claude Code Configuration Setup Script
# Syncs user-specific Claude configuration from dotfiles to ~/.claude

DOTFILES_CLAUDE="$HOME/.oh-my-zsh/custom/config/claude"
GLOBAL_CLAUDE="$HOME/.claude"

# Ensure global ~/.claude directory exists
mkdir -p "$GLOBAL_CLAUDE" 2>/dev/null

# Copy all .claude contents
cp -r "$DOTFILES_CLAUDE/"* "$GLOBAL_CLAUDE/" 2>/dev/null || true

# Ensure commands and plugins directories are copied
if [ -d "$DOTFILES_CLAUDE/commands" ]; then
  mkdir -p "$GLOBAL_CLAUDE/commands"
  cp -r "$DOTFILES_CLAUDE/commands/"* "$GLOBAL_CLAUDE/commands/" 2>/dev/null || true
fi

if [ -d "$DOTFILES_CLAUDE/plugins" ]; then
  mkdir -p "$GLOBAL_CLAUDE/plugins"
  cp -r "$DOTFILES_CLAUDE/plugins/"* "$GLOBAL_CLAUDE/plugins/" 2>/dev/null || true
fi

# Note: Voice notifications are generated on-demand by the notification handler

# Copy settings.json configuration
if [ -f "$DOTFILES_CLAUDE/settings.json" ]; then
  cp "$DOTFILES_CLAUDE/settings.json" "$GLOBAL_CLAUDE/settings.json"
else
  echo "⚠️  No settings.json found in $DOTFILES_CLAUDE" >&2
  exit 1
fi

echo "✓ Claude Code configuration synced"