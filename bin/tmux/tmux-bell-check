#!/bin/bash
# Cross-session tmux bell detection script
# Returns formatted bell indicator when any window has bells, empty otherwise

# Check if tmux is running
if ! command -v tmux >/dev/null 2>&1; then
    exit 0
fi

# Check if any tmux sessions exist
if ! tmux list-sessions >/dev/null 2>&1; then
    exit 0
fi

# Count windows with bell flags across all sessions
bell_count=$(tmux list-windows -a -F '#{window_bell_flag}' 2>/dev/null | grep -c '^1$' || echo "0")

# If bells exist, output the formatted indicator
if [ "$bell_count" -gt 0 ]; then
    # Following Catppuccin pattern exactly: using same rounded corner characters as windows
    echo "#[fg=#f9e2af]î‚¶#[fg=#11111b,bg=#f9e2af,bold]ðŸ”” NEW #[fg=#313244]"
fi

